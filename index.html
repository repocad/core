<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Internet Of Digital Design</title>
    <meta name="description" content="Language for CAD">
    <meta name="author" content="Selftie Software">

    <link href='http://fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">

    <link rel="icon" type="image/png" href="images/favicon.png" />
</head>
<body>

<style>
    #canvas {
        border: 1px solid #777;
    }
    #input {
        font-family: monospace;
        padding: 10px 7px;
    }
    #parse, #clear {
        height: 3em;
    }
</style>

<div class="container" id="container">

    <div class="row">
        <h2>Internet of Digital Design</h2>
    </div>
    <div class="row">
        <a class="button five columns" href="https://github.com/siigna/web/blob/master/IOD_manifest.pdf?raw=true">
            <i class="fa fa-lg fa-chevron-circle-right"></i> About <i>'The internet of digital design'</i>
        </a>
        <a class="button three columns" href="https://twitter.com/siigna_com">
            <i class="fa fa-lg fa-twitter"></i> Follow on twitter
        </a>
        <a class="button four columns" href= "https://github.com/siigna/">
            <i class="fa fa-lg fa-github"></i> See the source code
        </a>
    </div>

    <div class="row">
        <div class="one columns">
            <br/>
            <!-- git based script- and drawings library goes here...

            link to minute paper script
            link to manifesto
            link to default script
            link to geometry script
            -->
            </div>
        <div class="five columns">
<textarea id="input" class="twelve columns">
#SCRIPT-EXAMPLE:
#minute paper: used by pilots - one minute between each line

#variables to customize the minute paper
scale = 500000 #chart scale that the paper will be used for
speedMin = 100
speedMax = 160
yStart = -110 # y-coord of the first speed line
textSize = 4

dist = speedMax - speedMin
distance = 250 / dist

for i <- speedMin to speedMax {
  y1 = yStart
  y2 = yStart + distance

  speed1 = i * 1852
  speed1div = speed1
  speed1min = speed1div / 6
  speed1mm = speed1min * 100

  plusOne = i + 1
  speed2 = plusOne * 1852
  speed2div = speed2
  speed2min = speed2div / 6
  speed2mm = speed2min * 100

  # scale down to the paper scale
  scaleDiv = scale / 10
  s1 = speed1mm / scaleDiv
  s2 = speed2mm / scaleDiv

  #minute lines
  min = -720 / s1
  max = 800 / s1
  for j <- min to max {
    spacing1 = j * s1
    spacing2 = j * s2
    line spacing1 / 10 y1 spacing2 / 10 y2
  }

  line -80 y1 80 y1 #speed lines

  text -90 y1 textSize i #show knots

  yStart = yStart + distance
}

line -80 yStart 80 yStart #last speed line
text -90 130 textSize speedMax #last speed text
text -89 -130 6 1 #show the minute paper scale
text -80 -130 6 scale #show the minute paper scale

#5cm: use to x-check the size of the printed minute paper with a ruler
line 90 60 90 70
line 90 80 90 90
line 90 100 90 110

</textarea>
            <div class="row">
                <button id="Save" class="six columns" title="Store online">
                    <i class="fa fa-save fa-lg"></i> Save online
                </button>
                <button id="toPdf" class="six columns">
                    <i class="fa fa-file-pdf-o fa-lg"></i> Print to PDF
                </button>
            </div>
            <div id="debug"></div>
        </div>

        <div class="five columns">
            <canvas id="canvas"></canvas>
        </div>
    </div>

    <footer class="row">
        Copyright (c) Selftie Software, licensed under the open-source license <a href="http://www.gnu.org/copyleft/gpl.html">GPL</a>.
    </footer>
</div>

<!-- Include Scala.js compiled code -->
<script type="text/javascript" src="./target/scala-2.11/web-fastopt.js"></script>
<script type="text/javascript" src="js/jspdf.min.js"></script>

<!-- Run tutorial.webapp.TutorialApp -->
<script type="text/javascript">
    var canvas = document.getElementById("canvas");
    var container = document.getElementById("container");
    var debug  = document.getElementById("debug");
    var input  = document.getElementById("input");
    var toggleRun = document.getElementById("toggleRun");
    var toPdf = document.getElementById("toPdf");
    var siigna = new Siigna(canvas, input, debug);

    input.style.height = window.innerHeight * 0.7 - 52 + "px";
    canvas.width = container.offsetWidth / 2 - 20;
    canvas.height = window.innerHeight * 0.7;

    function MouseWheelHandler(e) {

        // cross-browser wheel delta
        var e = window.event || e; // old IE support
        var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));
        siigna.zoom(delta, e);

        // Stop scroll from happening
        if (e.preventDefault)
            e.preventDefault();
        return false;
    }

    if (canvas.addEventListener) {
        // IE9, Chrome, Safari, Opera
        canvas.addEventListener("mousewheel", MouseWheelHandler, false);
        // Firefox
        canvas.addEventListener("DOMMouseScroll", MouseWheelHandler, false);
    }

    window.onload = function (e) {
        siigna.init();
        toggleRun.onclick = function (e) {
            var b = siigna.toggleRepl();
            if (b) {
                toggleRun.innerHTML = "<i class='fa fa-stop fa-lg'></i> Stop";
                siigna.run(input.value);
            } else {
                toggleRun.innerHTML = "<i class='fa fa-play fa-lg'></i> Run";
            }
        };

        toPdf.onclick = function (e) {
            siigna.printPdf("IOD_2d_print.pdf");
        }
    };
</script>
</body>
</html>